<!DOCTYPE html>
<html lang="ko">
<head>
<title>폼당폼당</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no, address=no, email=no">
<link href="../css/common.css" type="text/css" rel="stylesheet">
<link href="../css/admin.css" type="text/css" rel="stylesheet">
<script src="../js/jquery-1.12.4.min.js"></script>
<script src="../js/nice-select/jquery.nice-select.js"></script>
</head>
<body>
<div id="wrap">
	<header id="header" class="admin_header">
        <div class="mob-head">
            <h1 class="logo"><a href="./"><img src="../image/common/logo_vertical.png" alt="폼당폼당" class="w4em"></a></h1>
            <p class="bt-group"><a href="write.html">폼 작성하기 <i class="ico"></i></a></p>
            <nav class="gnb">
                <ul>
                    <li><a href="index.html"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"><path style="fill:currentColor" fill-rule="evenodd" d="M3.47 7.03c.15.15.34.22.53.22s.38-.07.53-.22l3-3c.29-.29.29-.77 0-1.06a.754.754 0 0 0-1.06 0L4 5.44l-.47-.47a.754.754 0 0 0-1.06 0c-.29.29-.29.77 0 1.06l1 1ZM21 6.25H11c-.41 0-.75-.34-.75-.75s.34-.75.75-.75h10c.41 0 .75.34.75.75s-.34.75-.75.75Zm-10 7h10c.41 0 .75-.34.75-.75s-.34-.75-.75-.75H11c-.41 0-.75.34-.75.75s.34.75.75.75Zm0 7h10c.41 0 .75-.34.75-.75s-.34-.75-.75-.75H11c-.41 0-.75.34-.75.75s.34.75.75.75Zm-7-6c-.19 0-.38-.07-.53-.22l-1-1a.754.754 0 0 1 0-1.06c.29-.29.77-.29 1.06 0l.47.47 2.47-2.47c.29-.29.77-.29 1.06 0 .29.29.29.77 0 1.06l-3 3c-.15.15-.34.22-.53.22Zm-.53 6.78c.15.15.34.22.53.22s.38-.07.53-.22l3-3c.29-.29.29-.77 0-1.06a.754.754 0 0 0-1.06 0L4 19.44l-.47-.47a.754.754 0 0 0-1.06 0c-.29.29-.29.77 0 1.06l1 1Z" clip-rule="evenodd"/></svg> 내 폼 보기</a></li>
                    <li><a href="group_write.html"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"><path style="fill:currentColor" fill-rule="evenodd" d="M5.54 19.52c-.61 0-1.18-.21-1.59-.6-.52-.49-.77-1.23-.68-2.03l.37-3.24c.07-.61.44-1.42.87-1.86l6.837-7.237a.707.707 0 0 1 .025-.026L12.72 3.1c2.05-2.17 4.19-2.23 6.36-.18s2.23 4.19.18 6.36l-8.21 8.69c-.42.45-1.2.87-1.81.97l-3.22.55-.177.013c-.102.009-.2.017-.303.017Zm.06-6.71 5.918-6.272a6.86 6.86 0 0 0 4.353 4.125L9.95 16.93c-.2.21-.68.47-.97.52L5.76 18c-.33.05-.6-.01-.78-.18-.18-.17-.26-.44-.22-.77l.37-3.24c.04-.29.27-.79.47-1Zm12.56-4.57-1.105 1.17a5.372 5.372 0 0 1-4.342-4.137L13.81 4.11c.68-.72 1.35-1.2 2.12-1.2.62 0 1.31.32 2.11 1.09 1.81 1.7 1.36 2.92.12 4.24ZM3 22.75h18c.41 0 .75-.34.75-.75s-.34-.75-.75-.75H3c-.41 0-.75.34-.75.75s.34.75.75.75Z" clip-rule="evenodd"/></svg> 폼당 그룹결성</a></li>
                    <li><a href="group_list.html"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"><path style="fill:currentColor" fill-rule="evenodd" d="M19.25 17.353a2.75 2.75 0 0 0-2 2.647c0 1.52 1.23 2.75 2.75 2.75s2.75-1.23 2.75-2.75a2.75 2.75 0 0 0-2-2.647V14c0-2.42-1.33-3.75-3.75-3.75h-4.25V6.647a2.75 2.75 0 0 0 2-2.647c0-1.52-1.23-2.75-2.75-2.75S9.25 2.48 9.25 4c0 1.26.845 2.32 2 2.647v3.603H7c-2.42 0-3.75 1.33-3.75 3.75v3.353a2.75 2.75 0 0 0-2 2.647c0 1.52 1.23 2.75 2.75 2.75S6.75 21.52 6.75 20a2.75 2.75 0 0 0-2-2.647V14c0-1.58.67-2.25 2.25-2.25h4.25v5.603a2.75 2.75 0 0 0-2 2.647c0 1.52 1.23 2.75 2.75 2.75s2.75-1.23 2.75-2.75a2.75 2.75 0 0 0-2-2.647V11.75H17c1.58 0 2.25.67 2.25 2.25v3.353ZM4 18.75a1.25 1.25 0 1 0 0 2.5 1.25 1.25 0 0 0 0-2.5Zm16 0a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5ZM13.25 4a1.25 1.25 0 1 1-2.5 0 1.25 1.25 0 0 1 2.5 0ZM12 18.75a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5Z" clip-rule="evenodd"/></svg> 내 그룹 보기</a></li>
                </ul>
            </nav>
			<a onclick="logout()" class="bt-logout"><i class="ico i-logout"></i> Logout</a>
        </div>
        <button type="button" class="bt-menu"><span class="skip">메뉴</span></button>
		<div class="member-logout">
			<div class="user_login">
                <input type="file" id="profile-img" onchange="handel_profile(event)" style="display: none;">
                <figure><img src="../image/common/not_profile.svg" alt="profile"></figure>
				<span><em id="user_name1"></em> <i class="ico"></i></span>
			</div>
            <div class="modal-layer mem_info">
                <figure ><img src="../image/common/not_profile.svg" alt=""> <button type="button" onclick="open_profile_upload();"><i class="ico"></i> <span class="skip">프로필 사진 등록</span></button></figure>
				<strong id="user_name2"></strong>
				<a onclick="logout()" class="bt-logout"><i class="ico i-logout"></i> Logout</a>
                <button type="button" class="bt-close"><span class="skip">닫기</span></button>
            </div>
        </div>
    </header>
	<div id="container">
		<h2 class="sub-tit">그룹 삭제</h2>
		<div id="contents" class="group-wrap">
            <div class="group-write">
                <h4>그룹 프로필</h4>
                    <fieldset>
                        <legend>그룹 삭제하기</legend>
                        <div class="forms-write-wrap">
                            <div class="frm-area">
                                <div class="inp-group">
                                    <label for="grp_name"><em>필수</em> 그룹 이름</label><input type="text" name="" class="it" id="grp_name" readonly disabled>
                                </div>
                                <p>삭제할 그룹 이름을 확인하세요.</p>
                            </div>
                            <div class="frm-area">
                                <div class="inp-group">
                                    <label for="grp_pw"><em>필수</em> 그룹 비밀번호</label><input type="password" name="" class="it" id="grp_pw">
                                </div>
                                <p>그룹 비밀번호를 입력하세요.</p>
                            </div>
                            <div class="frm-area">
                                <div class="inp-group">
                                    <label for="grp_remove"><em>필수</em> 삭제확인</label><input type="text" name="" placeholder="삭제할 그룹 이름을 입력해주세요." class="it" id="grp_remove">
                                </div>
                                <p>"삭제"를 위해 그룹 이름을 입력해주세요.</p>
                            </div>
                        </div>
                        <div class="bt-group">
                            <button id="create-btn" onclick="groupRemove()" class="st-fill" style="opacity: 0.65; pointer-events: none" disabled><span>그룹 삭제</span> <i class="ico"></i></button>
                        </div>
                    </fieldset>
            </div>
		</div>
	</div>
</div>
<script src="../js/common/cons.js"></script>
<script src="../js/common.js"></script>
<script src="../js/common/util.js"></script>
<script src="../js/admin/common/modal.js"></script>
<script src="../js/admin/common/img.js"></script>
<script src="../js/common/net.js"></script>

<script>
$(document).ready(function() {
    $('.layer-sel').niceSelect();
    groupDetail();

document.getElementById('grp_remove').addEventListener('input', function() {
    var grpNameValue = document.getElementById('grp_name').value;
    var grpRemoveValue = document.getElementById('grp_remove').value;
    var button = document.getElementById('create-btn');

    if(grpNameValue === grpRemoveValue) {
        button.style.opacity = '1.0';
        button.disabled = false;
        button.style.pointerEvents = 'auto';
    } else {
        if(!button.disabled) {
            button.style.opacity = '0.65';
            button.disabled = true;
            button.style.pointerEvents = 'none';
        }
    }
});

});

function groupRemove() {
      const urlParams = new URLSearchParams(window.location.search);
      const gidValue = urlParams.get('gid');
      const groupSession = urlParams.get('group_session');

      const pw = $("#grp_pw").val()
      const remove = $("#grp_remove").val()

	  if ([null, undefined, ''].includes(pw)) {
			alert("그룹 패스워드를 작성해주세요.");
			return false;
      }

	  if ([null, undefined, ''].includes(remove)) {
			alert("그룹 삭제 확인란을 작성해주세요.");
			return false;
      }

      if(gidValue && groupSession) {
          $.ajax({
              type: 'POST',
              url: 'https://formdang-api.com/api/dj/group/delete',
              data: {pw:pw, gid:gidValue, group_session:groupSession, group_name:remove},
              headers: {
                  'Authorization': 'Bearer ' + localStorage.getItem('accessToken')
              },
              success: function (response) {
                    if(response.proc == "success") {
                        alert("그룹 삭제 성공");
                        location.replace(`/admin/group_list.html`)
                    }else {
                        alert('그룹 삭제 실패');
                        console.log(response)
                        console.log(response.proc)
                        return false;
                    }
              },
              error: function (error) {
                  console.error('AJAX 요청 실패:', error);
              }
          });
      }
}

function groupDetail() {
      const urlParams = new URLSearchParams(window.location.search);
      const gidValue = urlParams.get('gid');
      const groupSession = urlParams.get('group_session');

      if(gidValue && groupSession) {
          $.ajax({
              type: 'GET',
              url: 'https://formdang-api.com/api/dj/group/profile-update',
              data: {gid:gidValue, group_session:groupSession},
              headers: {
                  'Authorization': 'Bearer ' + localStorage.getItem('accessToken')
              },
              success: function (response) {
                      $("#grp_name").val(response.group)
                      $('.layer-sel').niceSelect('update');
              },
              error: function (error) {
                  console.error('AJAX 요청 실패:', error);
              }
          });
      }
}


function ok_popup() {
    if (modal_type == 'C') { // 모달 닫기 버튼
        close_popup();
    }
}

/**
 * 모달 닫기 처리
 */
function close_popup() { // 팝업 닫기
    document.getElementById('modal_layer').style.display = "none";
    document.body.style.overflow = "auto";
}
</script>
</body>
</html>
